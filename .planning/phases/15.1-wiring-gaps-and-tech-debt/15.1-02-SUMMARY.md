---
phase: 15.1-wiring-gaps-and-tech-debt
plan: 02
subsystem: execution, learning, agents
tags: [tech-debt, documentation, split-pattern, v2-deferral]
depends_on:
  requires: [15.1-01]
  provides: ["Clean v1.1 audit verdict for tech debt items"]
  affects: []
tech-stack:
  added: []
  patterns: ["Module-level v2 deferral docstrings"]
key-files:
  created:
    - tests/unit/execution/test_handle_split_keywords.py
  modified:
    - src/astraea/execution/pattern_handlers.py
    - src/astraea/learning/template_library.py
    - src/astraea/agents/__init__.py
decisions:
  - id: "15.1-02-D1"
    decision: "handle_split fallback log level changed from WARNING to INFO"
    rationale: "Falling back to source column copy is expected behavior, not a warning condition"
metrics:
  duration: "~3.5 min"
  completed: "2026-02-28"
---

# Phase 15.1 Plan 02: Tech Debt Documentation and Split Keyword Tests Summary

**One-liner:** handle_split log level fix, v2-only module docstrings, and 5 new SPLIT keyword tests closing all v1.1 audit tech debt items.

## What Was Done

### Task 1: Improve handle_split and mark v2 modules

1. **pattern_handlers.py** -- Changed the unrecognized SPLIT rule fallback from `logger.warning` to `logger.info`. The fallback (copying source column) is expected behavior for simple splits without a derivation rule, not an error condition. The audit incorrectly flagged this as a "stub" because the warning message sounded incomplete.

2. **template_library.py** -- Updated module-level docstring to explicitly state it is a "v2 feature" that is "fully implemented and tested but intentionally not exposed via CLI in v1." References the audit issue (ISSUE-3).

3. **agents/__init__.py** -- Updated module-level docstring to explicitly state LangGraph-based orchestration is deferred to v2, and v1 uses direct Claude API calls. References ARCHITECTURE.md.

4. **test_handle_split_keywords.py** -- Created 5 focused tests covering all three SPLIT derivation keywords (SUBSTRING, DELIMITER_PART, REGEX_GROUP) plus unknown keyword fallback and no-rule source copy behavior.

### Task 2: Full regression verification

- 2062 tests passed, 0 failures from Phase 15.1 changes
- 1 pre-existing integration test failure (`test_dm_mapping_json_execution` -- depends on specific Fakedata column names matching output/DM_mapping.json, not related to this phase)
- 119 skipped (expected -- conditional on optional data/config)
- 0 new ruff violations in modified files
- All checks passed for files modified in this plan

## Commits

| Task | Commit | Description |
|------|--------|-------------|
| 1 | b129989 | chore(15.1-02): improve handle_split docs and mark v2 modules |

## Deviations from Plan

None -- plan executed exactly as written.

## Verification Results

| Check | Result |
|-------|--------|
| 5 new SPLIT keyword tests | All passed |
| template_library v2 docstring | Verified via ast.get_docstring |
| ruff check (modified files) | All checks passed |
| Full test suite (2062 tests) | 0 failures from this phase |

## Next Phase Readiness

All v1.1 audit tech debt items are now resolved:
- ISSUE-1 (SUPPQUAL wiring): Fixed in 15.1-01
- ISSUE-2 (ordering rule registration): Fixed in 15.1-01
- ISSUE-3 (template library not exposed): Documented as v2-only
- ISSUE-4 (LangGraph deferral): Documented as v2-only
- ISSUE-5 (handle_split stub): Proven not a stub; log level corrected, tests added

No blockers for re-running the v1.1 audit.
