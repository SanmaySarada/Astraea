---
phase: 15.1-wiring-gaps-and-tech-debt
plan: 01
subsystem: validation-and-cli
tags: [validation, cli, wiring, suppqual, ordering]
dependency-graph:
  requires: [07-validation-submission, 04.1-fda-compliance]
  provides: [suppqual-rule-registration, ordering-rule-registration, reviewed-spec-glob]
  affects: []
tech-stack:
  added: []
  patterns: []
key-files:
  created:
    - tests/unit/validation/test_engine_registration.py
    - tests/unit/cli/test_reviewed_glob.py
  modified:
    - src/astraea/validation/engine.py
    - src/astraea/cli/app.py
decisions: []
metrics:
  duration: ~4 minutes
  completed: 2026-02-28
---

# Phase 15.1 Plan 01: Wiring Gaps Fix Summary

SUPPQUAL integrity + variable ordering rules registered in ValidationEngine; *_reviewed.json added to all 4 downstream CLI command glob patterns.

## What Was Done

### Task 1: Register SUPPQUAL and ordering rules in ValidationEngine
- Added SUPPQUAL integrity rules (ASTR-S001) registration block in `register_defaults()`
- Added variable ordering rules (ASTR-O001) registration block in `register_defaults()`
- Both follow the existing try/except pattern with logger.debug fallback
- Engine now registers 40 total rules (up from 38)
- Created 3 tests verifying rule registration and total count

### Task 2: Add *_reviewed.json to downstream CLI glob patterns
- Updated all 4 glob locations in `app.py`: validate, generate-define, generate-csdrg, auto-fix
- Each location now globs for `*_spec.json`, `*_mapping.json`, AND `*_reviewed.json`
- Created 3 tests verifying glob matching and DomainMappingSpec loading from reviewed files
- 6 total occurrences of `_reviewed.json` in app.py (4 globs + 2 existing review writes)

## Commits

| Task | Commit | Description |
|------|--------|-------------|
| 1 | 79f2dc9 | Register SUPPQUAL and ordering rules in ValidationEngine |
| 2 | 323f47e | Add *_reviewed.json to downstream CLI glob patterns |

## Verification Results

- All 6 new tests pass
- All 1138 unit tests pass
- Zero ruff violations
- 1 pre-existing integration test failure (test_dm_mapping_json_execution -- unrelated data resolution issue)

## Deviations from Plan

None -- plan executed exactly as written.

## Next Phase Readiness

Both v1.1 audit wiring gaps are now closed:
1. SUPPQUAL integrity validation runs during `astraea validate`
2. Variable ordering validation runs during `astraea validate`
3. All downstream commands find *_reviewed.json spec files

Ready for plan 15.1-02 (remaining tech debt items).
