---
phase: 02.1-ref-data-fixes
plan: 01
subsystem: reference
tags: [cdisc, ct, codelists, nci, c-codes, sdtm-ig]

# Dependency graph
requires:
  - phase: 01-foundation
    provides: CT reference module and bundled codelists.json
provides:
  - Corrected NCI C-codes for all 11 CT codelists
  - Race codelist marked extensible
  - NY codelist with U (Unknown) term
  - Regression tests preventing future C-code errors
affects: [02.1-ref-data-fixes plans 02-04, 03-mapping-engine]

# Tech tracking
tech-stack:
  added: []
  patterns: []

key-files:
  created: []
  modified:
    - src/astraea/data/ct/codelists.json
    - tests/test_reference/test_controlled_terms.py

key-decisions:
  - "Race codelist uses C74457 (not C66767 which is Action Taken)"
  - "Country codelist uses ISO3166 key (not a retired NCI C-code)"
  - "Age Unit (C66781) variable_mappings narrowed to AGEU only; general Unit is C71620"

patterns-established:
  - "C-code verification tests as regression guards for reference data"

# Metrics
duration: 4min
completed: 2026-02-27
---

# Phase 2.1 Plan 01: CT Codelist C-Code Fixes Summary

**Fixed 9 of 11 wrong NCI C-codes in codelists.json with swap-safe rewrite, added NY "U" term, set Race extensible**

## Performance

- **Duration:** 4 min
- **Started:** 2026-02-27T05:37:25Z
- **Completed:** 2026-02-27T05:41:25Z
- **Tasks:** 2/2
- **Files modified:** 2

## Accomplishments
- Corrected all 9 wrong NCI C-codes (systematic code swaps from initial data entry)
- Added missing "U" (Unknown) term to NY codelist (C66742)
- Set Race codelist extensible flag to true (was incorrectly false)
- Added 12 new verification tests + 1 regression guard test for old wrong codes
- Full test suite passes: 440 tests, zero regressions

## Task Commits

Each task was committed atomically:

1. **Task 1: Fix all NCI C-codes and term-level issues in codelists.json** - `0a0c7d0` (fix)
2. **Task 2: Update tests to verify corrected C-codes** - `8ebb12e` (test)

## Files Created/Modified
- `src/astraea/data/ct/codelists.json` - All 11 codelist keys and inner codes corrected; Race extensibility fixed; NY U term added
- `tests/test_reference/test_controlled_terms.py` - Updated existing tests for new C-codes; added TestCodelistCCodesVerified class with 12 individual verification tests + old-code regression guard

## Decisions Made
- Built the corrected JSON from scratch for affected entries to avoid swap collisions (C66790 was both old NY key and new Ethnicity key)
- Country codelist keyed as "ISO3166" (not an NCI C-code) since C66786 was retired in 2016
- Age Unit (C66781) variable_mappings narrowed to ["AGEU"] only; general unit variables moved to C71620

## Deviations from Plan
None - plan executed exactly as written.

## Issues Encountered
None.

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- CT codelist C-codes are now correct, unblocking plans 02-04 which fix domains.json codelist assignments
- The variable_mappings in codelists.json now correctly separate Age Unit (C66781 -> AGEU) from general Unit (C71620 -> CMDOSU, EXDOSU, etc.)
- domains.json still references old C-codes in its variable codelist assignments -- this is fixed in plan 02

---
*Phase: 02.1-ref-data-fixes*
*Completed: 2026-02-27*
